@page "/xedetail"
@page "/xedetail/{id:int}"
@using CarManager.Models
@using CarManager.Shared
@inject IXeService XeServices
@inject NavigationManager NavigationManager
@if (Id == null)
{
    <PageTitle>Create a new car</PageTitle>
    <h3>Create a new car</h3>
}
else
{
    <PageTitle>Edit @xe.TenXe</PageTitle>
    <h3>Edit @xe.TenXe</h3>
}
<EditForm Model="xe" OnSubmit="HandleSubmit">
    <div>
        <label for="xeid">Mã xe</label>
        <InputText id="xeid" @bind-Value="xe.XeId" class="form-control"></InputText>
    </div>
    <div>
        <label for="tenxe">Tên xe</label>
        <InputText id="tenxe" @bind-Value="xe.TenXe" class="form-control"></InputText>
    </div>
    <div>
        <label for="bienso">Biển số</label>
        <InputText id="bienso" @bind-Value="xe.BienSo" class="form-control"></InputText>
    </div>
    <div>
        <label for="taitrong">Tải trọng</label>
        <InputText id="taitrong" @bind-Value="xe.TaiTrong" class="form-control"></InputText>
    </div>
    <div>
        <label for="tuyenduongid">Mã tuyến đường</label>
        <InputNumber id="tuyenduongid" @bind-Value="xe.TuyenDuongId" class="form-control"></InputNumber>
    </div>
    
    
    <br />
    <button type="submit" class="btn btn-primary">@btnText</button>
@*    <button type="button" class="btn btn-danger" @onclick="DeleteXe">Delete</button>*@
    <button type="button" class="btn btn-danger" @onclick="Cancel">Cancel</button>
</EditForm>
@code {
    [Parameter]
    public int? Id { get; set; }

    string btnText = string.Empty;
    Xe xe = new Xe();
    
    protected override async Task OnInitializedAsync()
    {
        btnText = Id == null ? "Save" : "Update";
    }

    protected override async Task OnParametersSetAsync()
    {
        if (Id != null)
        {
            xe = await XeServices.GetSingleXe((int)Id);
        }
       
        
    }

    async Task HandleSubmit()
    {
        if (Id == null)
        {
            await XeServices.CreateXe(xe);
        }
        else
        {
            await XeServices.UpdateXe(xe);
        }
    }
    async Task Cancel()
    {
        NavigationManager.NavigateTo("/carmanage");
    }
}
